"use strict";function BF(){}
BF.initialize=function(){BF.navbarObj=new BF.Navbar();BF.__init_sticky_footer();BF.__init_alerts();}
BF.Type=function(){}
BF.Type.isNumber=function(value){return typeof(value)==='number'&&!isNaN(value);}
BF.Type.isHTMLElement=function(value){try{return value instanceof HTMLElement;}catch(e){return value!==null&&typeof(value)==='object'&&value.nodeType===1&&typeof(value.nodeName)==='string';}}
BF.Subscription=function(){this.subscriptionList=[];Object.defineProperty(this,"numSubscribers",{get:function(){return this.subscriptionList.length;}});this.subscribe=function(funcToCall){this.subscriptionList.push(funcToCall);}
this.callSubscribers=function(_arg){for(var ii=0;ii<this.subscriptionList.length;ii+=1){var funcToCall=this.subscriptionList[ii];funcToCall(_arg);}}}
BF.TimedCode=function(){}
BF.TimedCode.runAfterDelay=function(func,delayMS){var timeoutID=window.setTimeout(func,delayMS);}
BF.TimedCode.runAtInterval=function(func,intervalMS,_maxCount){var callCount=0;var intervalID=window.setInterval(function(){func();callCount+=1;if(_maxCount&&callCount>=_maxCount){window.clearInterval(intervalID);}},intervalMS);}
BF.Math=function(){}
BF.Math.round=function(num,digits){if(!digits){return Math.round(num);}else{var mult=Math.pow(10,digits);return Math.round(num*mult)/mult;}}
BF.MathJax=function(){}
BF.MathJax.fitEquations=function(containerClass){var allContainers=document.getElementsByClassName(containerClass);for(var ii=0;ii<allContainers.length;ii+=1){var container=allContainers[ii];var cntrWidth=container.offsetWidth;container.style.position="absolute";var eqnWidth=container.offsetWidth;container.style.position="";if(eqnWidth>cntrWidth){container.style.fontSize=Math.floor((cntrWidth/eqnWidth)*100)+'%';}}}
BF.MathJax.applyStyle=function(containerClass,styleStr){var allContainers=document.getElementsByClassName(containerClass);for(var ii=0;ii<allContainers.length;ii+=1){var container=allContainers[ii];var mathJaxDivs=container.getElementsByClassName("MathJax_Display");for(var jj=0;jj<mathJaxDivs.length;jj+=1){var mjDiv=mathJaxDivs[jj];mjDiv.setAttribute("style",styleStr);}}}
BF.AJAX=function(){}
BF.AJAX.get=function(inputsDic){BF.AJAX.sendRequest(inputsDic.url,"GET",undefined,inputsDic.onDone,inputsDic.onFail);}
BF.AJAX.post=function(inputsDic){BF.AJAX.sendRequest(inputsDic.url,"POST",inputsDic.args,inputsDic.onDone,inputsDic.onFail);}
BF.AJAX.sendRequest=function(url,method,argsDic,funcOnDone,funcOnFail){var req=new XMLHttpRequest();req.onreadystatechange=function(){if(req.readyState===4){if(req.status===200){var resp='response'in req?req.response:req.responseText;funcOnDone(resp);}else{funcOnFail({'status':req.status,'statusText':req.statusText});}}}
var isAsync=true;req.open(method,url,isAsync);req.setRequestHeader("Content-Type","application/x-www-form-urlencoded");if(method==="POST"){var argsStr="";var props=Object.keys(argsDic);for(var ii=0;ii<props.length;ii++){var name=props[ii];var value=argsDic[name];if(typeof(value)!=="string"){value=JSON.stringify(value);}
value=encodeURIComponent(value);var prefix=(argsStr=="")?"":"&";argsStr+=prefix+name+"="+value;}
req.send(argsStr);}else{req.send();}}
BF.HTTP=function(){}
BF.HTTP.post=function(url,args){var htmlTemplate={tag:"div",style:"display: none;",children:{form:{tag:"form",children:{}}}};var props=Object.keys(args);for(var ii=0;ii<props.length;ii+=1){var propName=props[ii];var value=args[propName];htmlTemplate.children.form.children[propName]={tag:"input",type:"text",name:propName,value:value};}
var formGroup=new BF.Element(htmlTemplate);formGroup.form.elm.setAttribute("action",url);formGroup.form.elm.setAttribute("method","post");document.body.appendChild(formGroup.elm);formGroup.form.elm.submit();document.body.removeChild(formGroup.elm);}
BF.Element=function(template){this.tag=template.tag;this.elm=document.createElement(this.tag);Object.defineProperty(this,"id",{get:function(){return this.elm.id;},set:function(value){if(value!=undefined){this.elm.setAttribute("id",value);}}});Object.defineProperty(this,"name",{get:function(){return this.elm.name;},set:function(value){if(value!=undefined){this.elm.setAttribute("name",value);}}});Object.defineProperty(this,"type",{get:function(){return this.elm.type;},set:function(value){if(!("type"in this.elm)){console.warn('"type" property does not exist in this element!');return;}
if(value!=undefined){this.elm.setAttribute("type",value);}}});Object.defineProperty(this,"cls",{get:function(){return this.elm.className;},set:function(value){if(value!=undefined){this.elm.setAttribute("class",value);}}});Object.defineProperty(this,"style",{get:function(){return this.elm.style;},set:function(value){if(value!=undefined){this.elm.setAttribute("style",value);}}});Object.defineProperty(this,"height",{get:function(){return this.elm.height;},set:function(value){if(value!=undefined){this.elm.setAttribute("height",value);}}});Object.defineProperty(this,"width",{get:function(){return this.elm.width;},set:function(value){if(value!=undefined){this.elm.setAttribute("width",value);}}});Object.defineProperty(this,"innerHTML",{get:function(){return this.elm.innerHTML;},set:function(value){if(value!=undefined){this.elm.innerHTML=value;}}});Object.defineProperty(this,"value",{get:function(){return this.elm.value;},set:function(value){this.elm.value=value;}});Object.defineProperty(this,"src",{get:function(){return this.elm.src;},set:function(value){if(value!=undefined){this.elm.setAttribute("src",value);}}});Object.defineProperty(this,"placeholder",{get:function(){return this.elm.placeholder;},set:function(value){if(value!=undefined){this.elm.setAttribute("placeholder",value);}}});Object.defineProperty(this,"visible",{get:function(){return!(this.elm.style.display=='none');},set:function(value){if(value==false){this.elm.style.display='none';}else{this.elm.style.display='inherit';}}});this.setTooltip=function(text,position){this.elm.setAttribute("tooltip",text);this.elm.setAttribute("tooltip-position",position);}
this.cls=template.cls;if(template.type){this.type=template.type};this.cls=template.cls;this.style=template.style;this.innerHTML=template.innerHTML;if(template.name){this.name=template.name}
if(template.value){this.value=template.value}
if(template.children){var childs=Object.keys(template.children);for(var ii=0;ii<childs.length;ii+=1){var childName=childs[ii];var childTemplate=template.children[childName];var childObj=new BF.Element(childTemplate);this.elm.appendChild(childObj.elm);this[childName]=childObj;}}}
BF.toggleStyle=function(elm,styleDic,intervalMS,_options){var options=_options||{};var maxCount=options.maxCount||2;if(typeof(elm)==="string"){elm=document.getElementById(elm);}
var styleOrig={};var styleProps=Object.keys(styleDic);for(var ii=0;ii<styleProps.length;ii++){var propName=styleProps[ii];styleOrig[propName]=elm.style[propName];}
var isHi=false;var flashFunc=function(){var styleDicNow=isHi?styleOrig:styleDic;for(var ii=0;ii<styleProps.length;ii++){var propName=styleProps[ii];elm.style[propName]=styleDicNow[propName];}
isHi=!isHi;}
BF.TimedCode.runAtInterval(flashFunc,intervalMS,maxCount);}
BF.toggleStyle_Array=function(arrElms,styleDic,intervalMS,_options){var options=_options||{};var delayMS=(options.delayMS!==undefined)?options.delayMS:100;var maxCount=options.maxCount||2;function getFlashFunc(index){var flashFunc=function(){var elm=arrElms[index];BF.toggleStyle(elm,styleDic,intervalMS,{'maxCount':maxCount});}
return flashFunc;}
for(var ii=0;ii<arrElms.length;ii++){var flashFunc=getFlashFunc(ii);BF.TimedCode.runAfterDelay(flashFunc,ii*delayMS);}}
BF.Navbar=function(){var thisObj=this;this.navElm=BF.Navbar.getNavbarElm();this.togglerElm=BF.Navbar.getTogglerElm();if(this.togglerElm){this.togglerElm.addEventListener("click",function(){if(thisObj.navElm.className.indexOf("expanded")==-1){thisObj.navElm.className+=" expanded";}else{thisObj.navElm.className=thisObj.navElm.className.replace(" expanded","");}});}}
BF.Navbar.getNavbarElm=function(){var navElms=document.getElementsByTagName('nav');for(var ii=0;ii<navElms.length;ii++){var navElm=navElms[ii];if(navElm.className.indexOf("navbar")!==-1){return navElm;}}
return undefined;}
BF.Navbar.getTogglerElm=function(){var nbElm=BF.Navbar.getNavbarElm();if(nbElm){var tl=nbElm.getElementsByClassName('nav-toggler');if(tl.length>0){return tl[0];}}
return undefined;}
BF.__init_sticky_footer=function(){var sf;var setMarginForFooter=function(){var bodyElm=document.getElementsByTagName("body")[0];if(bodyElm&&sf){bodyElm.style.marginBottom=sf.offsetHeight+32+"px";}}
var arrStkFt=document.getElementsByClassName("foot-sticky");if(arrStkFt.length>0){sf=arrStkFt[0];setMarginForFooter();var resizeTimeout;window.addEventListener("resize",function(event){window.clearTimeout(resizeTimeout);resizeTimeout=window.setTimeout(setMarginForFooter,250);});}}
BF.Sidebar=function(){}
BF.Sidebar.getSidebar=function(which){var cls='sidebar-'+which;var sb=document.getElementsByClassName(cls);if(sb.length>0){return sb[0];}
return undefined;}
BF.Sidebar.getAvailableHeight=function(which){var sb=BF.Sidebar.getSidebar(which);var sbHt=sb.clientHeight-sb.offsetTop;if(sb){var chlds=sb.children;for(var ii=chlds.length-1;ii>=0;ii--){var ch=chlds[ii];if(ch.style.display!=='none'&&ch.clientHeight>0){return sbHt-(ch.offsetTop+ch.clientHeight);}}}
return undefined;}
BF.Sidebar.showMaybe=function(elms,which){var sb=BF.Sidebar.getSidebar(which);var cs=getComputedStyle(sb);var oflow=cs.overflowY;sb.style.overflowY='hidden';for(var ii=0;ii<elms.length;ii++){var elm=elms[ii];if(typeof(elm)==='string'){elm=document.getElementById(elm);}
elm.style.visibility='hidden';elm.style.display='inherit';if(BF.Sidebar.getAvailableHeight(which)>0){elm.style.visibility='visible';}else{elm.style.display='none';}}
sb.style.overflowY=oflow;}
BF.TabGroup=function(id){var thisObj=this;this.onToggle=new BF.Subscription();var tabGroupElm;var tabListElm;var arrTabPairs=[];this.selectedTab=undefined;this.previousTab=undefined;var init=function(){tabGroupElm=document.getElementById(id);tabListElm=tabGroupElm.getElementsByClassName("tab-list")[0];var tabItems=tabListElm.getElementsByTagName("a");for(var ii=0;ii<tabItems.length;ii++){var item=tabItems[ii];arrTabPairs[ii]=new BF.TabPair(item,ii);item.addEventListener("click",handleTabClick);var childs=item.children;if(childs.length>0){for(var jj=0;jj<childs.length;jj++){var child=childs[jj];child.addEventListener("click",handleTabClick);}}}
thisObj.selectTab(0);}
this.selectTab=function(value){var selectedTab=getTabPair(value);if(!selectedTab){return;}
this.previousTab=this.selectedTab;this.selectedTab=selectedTab;if(this.previousTab){var prevLink=this.previousTab.linkElm;var prevPanel=this.previousTab.panelElm;if(prevLink.className){prevLink.className=prevLink.className.replace(" active","");}
if(prevPanel.className){prevPanel.className=prevPanel.className.replace(" active","");}}
if(this.selectedTab.linkElm.className.indexOf("active")===-1){this.selectedTab.linkElm.className+=" active";this.selectedTab.panelElm.className+=" active";}
this.onToggle.callSubscribers(this.selectedTab);}
this.flashTabs=function(_options){var options=_options||{};var tabStyle=options.tabStyle||{'backgroundColor':'PeachPuff'};var numFlashes=options.numFlashes||3;var holdTimeMS=options.holdTimeMS||550;var delayMS=(options.delayMS!==undefined)?options.delay:100;var arrLinkElms=[];for(var ii=0;ii<arrTabPairs.length;ii++){arrLinkElms.push(arrTabPairs[ii].linkElm);}
BF.toggleStyle_Array(arrLinkElms,tabStyle,holdTimeMS,{'delayMS':delayMS,'maxCount':2*numFlashes});}
var handleTabClick=function(e){e.preventDefault();thisObj.selectTab(e.target);}
var getTabPair=function(value){var getFromID=function(id){for(var ii=0;ii<arrTabPairs.length;ii++){if(arrTabPairs[ii].id===id){return arrTabPairs[ii];}}
return undefined;}
var tabPair;if(typeof(value)==='string'){tabPair=getFromID(value);}else if(typeof(value)==='number'){tabPair=arrTabPairs[value];}else if(BF.Type.isHTMLElement(value)){var href=value.getAttribute('href');if(!href){href=value.parentElement.getAttribute('href');}
if(href){var id=href.replace('#','');tabPair=getFromID(id);}}
return tabPair;}
init();}
BF.TabPair=function(linkElm,index){this.index=index;this.id=linkElm.getAttribute('href').replace('#','');this.linkElm=linkElm;this.panelElm=document.getElementById(this.id);}
BF.Carousel=function(id,_options){var thisObj=this;var options=_options||{};var interval=options.interval;var activeSlide=0;var carouselElm;var arrSlides;var arrIndicators=[];var ctrlPrev;var ctrlNext;var intervalID;var init=function(){if(typeof(id)==='string'){carouselElm=document.getElementById(id);}else if(typeof(id)==='number'){var arrCarousels=document.getElementsByClassName('carousel');carouselElm=arrCarousels[id];}
arrSlides=carouselElm.getElementsByClassName('carousel-item');var ctrlTmp=carouselElm.getElementsByClassName('carousel-control-prev');if(ctrlTmp.length>0){ctrlPrev=ctrlTmp[0];ctrlPrev.addEventListener("click",function(){thisObj.showPrev();resetInterval();});}
var ctrlTmp=carouselElm.getElementsByClassName('carousel-control-next');if(ctrlTmp.length>0){ctrlNext=ctrlTmp[0];ctrlNext.addEventListener("click",function(){thisObj.showNext();resetInterval();});}
var indCntnr=carouselElm.getElementsByClassName('carousel-indicators');if(indCntnr.length>0){indCntnr=indCntnr[0];arrIndicators=indCntnr.getElementsByTagName('span');}
for(var ii=0;ii<arrIndicators.length;ii++){var getClickHandler=function(index){return function(){thisObj.showSlide(index);resetInterval();};}
arrIndicators[ii].addEventListener("click",getClickHandler(ii));}
if(interval){setInterval();}
thisObj.showSlide(0);}
this.showSlide=function(index){for(var ii=0;ii<arrSlides.length;ii++){var slide=arrSlides[ii];slide.className=slide.className.replace(" active","");if(arrIndicators.length-1>=ii){var ind=arrIndicators[ii];ind.className=ind.className.replace(" active","");}}
arrSlides[index].className+=" active";if(arrIndicators.length-1>=index){arrIndicators[index].className+=" active";}
activeSlide=index;}
this.showPrev=function(){var index=activeSlide-1;if(index<0){index=arrSlides.length-1;}
thisObj.showSlide(index);}
this.showNext=function(){var index=activeSlide+1;if(index>arrSlides.length-1){index=0;}
thisObj.showSlide(index);}
var setInterval=function(){intervalID=window.setInterval(thisObj.showNext,interval);}
var resetInterval=function(){if(intervalID){window.clearInterval(intervalID);setInterval();}}
init();}
BF.init_collapse=function(){var arrCollapse=document.getElementsByClassName("collapse");for(var ii=0;ii<arrCollapse.length;ii++){arrCollapse[ii].addEventListener("click",function(){var trgtID=this.getAttribute("data-target");var trgtElm=document.getElementById(trgtID);var disp=trgtElm.style.display==="none"?"inherit":"none";trgtElm.style.display=disp;});}}
BF.GridTable=function(id,_options){var thisObj=this;var elms={table:undefined,head:undefined,body:undefined,foot:undefined,ftLeft:undefined,ftRight:undefined};var config={height:"100px",showFooter:false,funcDisp:function(rowIndex,record){return record?'Row '+(rowIndex+1)+' selected':'&nbsp;';}};var columns=[];var records=[];var sortDic={colIndex:undefined,field:undefined,dir:1};var styleSheetColWidth;var styleSheetColStyle;var selected;this.afterSelect=new BF.Subscription();this.afterSort=new BF.Subscription();var init=function(){clearSelected();buildStructure();elms.table.setAttribute("tabindex","-1");var headElm=document.head||document.getElementsByTagName("head")[0];styleSheetColWidth=document.createElement("style");styleSheetColStyle=document.createElement("style");headElm.appendChild(styleSheetColWidth);headElm.appendChild(styleSheetColStyle);thisObj.initialize(_options);var resizeTimeout;window.addEventListener("resize",function(event){window.clearTimeout(resizeTimeout);resizeTimeout=window.setTimeout(setColumnWidths,250);});elms.table.addEventListener("keydown",handleKeyDown);}
this.elms=elms;this.initialize=function(options){if(!options){return;}
if(options.config){this.setConfig(options.config);}
if(options.columns){this.setColumns(options.columns,options.columnGroups);}
if(options.records&&options.records.length>0){this.setRecords(options.records);}else{setBlankRows();}}
var scrollListenerSet=false;this.setConfig=function(cnfg){var props=Object.keys(cnfg);for(var ii=0;ii<props.length;ii++){var cName=props[ii];config[cName]=cnfg[cName];}
if(config.showFooter===false){elms.foot.style.display="none";}else if(scrollListenerSet===false){scrollListenerSet=true;var scrollTimeout;elms.body.addEventListener("scroll",function(){window.clearTimeout(scrollTimeout);scrollTimeout=window.setTimeout(setFooterText_Right,50);});}
if(config.height){elms.body.style.height=config.height;}
if(config.size){var cls=" size-"+config.size;if(elms.table.className.indexOf(cls)===-1){elms.table.className+=cls;}}}
this.setColumns=function(cols,_colGroups){columns=cols;elms.head.innerHTML="";var styleStr="";var row=elms.head.insertRow(0);for(var ii=0;ii<cols.length;ii++){var colDic=cols[ii];colDic.index=ii;var cell=row.insertCell(ii);cell.outerHTML="<th>"+colDic.caption+"</th>";if(!colDic.width){throw new Error('Must specify width property!');}
if(colDic.style){styleStr+="#"+id+" td:nth-child("+(ii+1)+"), "+"#"+id+" th:nth-child("+(ii+1)+") { "+colDic.style+" } ";}
if(colDic.thStyle){styleStr+="#"+id+" th:nth-child("+(ii+1)+") { "+colDic.thStyle+" } ";}
if(colDic.tdStyle){styleStr+="#"+id+" td:nth-child("+(ii+1)+") { "+colDic.tdStyle+" } ";}}
row.addEventListener("click",handleHeadClick);styleSheetColStyle.innerHTML=styleStr;if(_colGroups){var row=elms.head.insertRow(0);row.className+="col-group";for(var ii=0;ii<_colGroups.length;ii++){var colDic=_colGroups[ii];var cell=row.insertCell(ii);cell.outerHTML='<th colspan="'+colDic.span+'">'+colDic.caption+'</th>';}}
setColumnWidths();}
this.getColumns=function(){return columns;}
this.getColumn=function(id){var col=undefined;if(typeof(id)==="number"){col=columns[id];}else if(typeof(id)==="string"){for(var ii=0;ii<columns.length;ii++){if(columns[ii].field===id){col=columns[ii];break;}}}
return col;}
this.clearRecords=function(){records=[];elms.body.innerHTML="";printRecords([]);setColumnWidths();clearSelected();setFooterText_Right();setFooterText_Left();}
this.addRecords=function(recs){var arrRecObj;if(recs.length>0){if(typeof(recs[0])==="string"){arrRecObj=[];for(var ii=0;ii<recs.length;ii+=1){var json=recs[ii];var obj=JSON.parse(json);arrRecObj.push(obj);};}else if(typeof(recs[0])==="object"){arrRecObj=recs;}else{return;}
records=records.concat(arrRecObj);}else{arrRecObj=[];}
printRecords(arrRecObj);setFooterText_Right();setColumnWidths();}
this.setRecords=function(recs){records=[];elms.body.innerHTML="";this.addRecords(recs);}
this.getEmptyRecord=function(){var emptyRow={};for(var ii=0;ii<columns.length;ii+=1){var field=columns[ii]['field'];emptyRow[field]='';}
emptyRow.isEmpty=true;return emptyRow;}
this.unselectRow=function(){if(selected&&selected.rowElm){selected.rowElm.className=selected.rowElm.className.replace(" selected","");}
clearSelected();setFooterText_Left();}
this.selectRow=function(index){if(selected&&selected.rowElm){selected.rowElm.className=selected.rowElm.className.replace(" selected","");}
if(records.length>0){index=Math.min(Math.max(index,0),records.length-1);var row=elms.body.rows[index];if(row.className.indexOf("selected")===-1){row.className+=" selected";}
selected={rowIndex:index,rowElm:row,record:records[index]};ensureRowVisible(index);}else{clearSelected();}
setFooterText_Left();this.afterSelect.callSubscribers(selected);return selected;}
this.getSelected=function(){return selected;}
this.getSelectedRowIndex=function(){return(selected!==undefined)?selected.rowIndex:-1;}
this.redraw=function(){setColumnWidths();setBlankRows();setFooterText_Right();}
this.sort=function(colID,dir,_options){var options=_options||{};var showSortArrow=(options.showSortArrow===false)?false:true;var colDic=this.getColumn(colID);if(!colDic){return;}
var field=colDic.sortField||colDic.field;var hRow=elms.head.rows[elms.head.rows.length-1];if(sortDic.colIndex!==undefined){var thPrev=hRow.cells[sortDic.colIndex];thPrev.className="";}
dir=(dir===-1)?dir:1;if(showSortArrow){hRow.cells[colDic.index].className=(dir===1)?"sort-asc":"sort-desc";}
sortDic.colIndex=colDic.index;sortDic.field=field;sortDic.dir=dir;var compare=function(o1,o2){var f1=o1[field];var f2=o2[field];if(typeof(f1)==="string"){f1=f1.toLowerCase();}
if(typeof(f2)==="string"){f2=f2.toLowerCase();}
if(f1<f2){return-1*dir;}else if(f1>f2){return 1*dir;}else{return 0;}}
records.sort(compare);elms.body.innerHTML="";printRecords(records);clearSelected();this.afterSort.callSubscribers(sortDic);}
var buildStructure=function(){elms.table=document.getElementById(id);if(!elms.table){throw new Error("GridTable ID improperly specified!");}else if(elms.table.tagName.toLowerCase()!=="table"){throw new Error("GridTable must be a <table> element!");}
elms.head=document.createElement("thead");elms.table.appendChild(elms.head);elms.body=document.createElement("tbody");elms.table.appendChild(elms.body);elms.foot=document.createElement("tfoot");elms.table.appendChild(elms.foot);buildFooter();}
var buildFooter=function(){var fRow=elms.foot.insertRow(0);var f_td=fRow.insertCell(0);var fDivL=document.createElement("div");f_td.appendChild(fDivL);fDivL.innerHTML="&nbsp;";fDivL.style.width="75%";fDivL.style.textAlign="left";var fDivR=document.createElement("div");f_td.appendChild(fDivR);fDivR.innerHTML="&nbsp;";fDivR.style.width="25%";fDivR.style.textAlign="right";elms.ftLeft=fDivL;elms.ftRight=fDivR;}
var setColumnWidths=function(){var arrWidths=getColumnWidths();var styleStr="";for(var ii=0;ii<arrWidths.length;ii++){styleStr+="#"+id+" td:nth-child("+(ii+1)+"), "+"#"+id+" th:nth-child("+(ii+1)+") { max-width: "+arrWidths[ii]+"; min-width: "+arrWidths[ii]+" } ";}
styleSheetColWidth.innerHTML=styleStr;}
var getColumnWidths=function(){var arrWidths=[];var widthAvail=elms.body.clientWidth;var pxTaken=0;var pctTotal=0;for(var ii=0;ii<columns.length;ii++){var colDic=columns[ii];if(colDic.width.indexOf("px")!==-1){pxTaken+=Number(colDic.width.replace("px",""));arrWidths.push(colDic.width);}else if(colDic.width.indexOf("%")!==-1){var pct=Number(colDic.width.replace("%",""));pctTotal+=pct;arrWidths.push(pct);}}
for(var ii=0;ii<arrWidths.length;ii++){var wd=arrWidths[ii];if(typeof(wd)==='number'){var pxCol=(wd/pctTotal)*(widthAvail-pxTaken);arrWidths[ii]=BF.Math.round(pxCol,2)+"px";}}
return arrWidths;}
var printRecords=function(recs){clearBlankRows();for(var ii=0;ii<recs.length;ii++){var recObj=recs[ii];var row=elms.body.insertRow();for(var jj=0;jj<columns.length;jj++){var colDic=columns[jj];var field=colDic.field;var value=(field in recObj&&recObj[field]!==undefined)?recObj[field]:'';var cell=row.insertCell(jj);cell.innerHTML=value;}
row.addEventListener("click",handleRowClick);}
setBlankRows();}
var clearBlankRows=function(){for(var ii=elms.body.rows.length-1;ii>=0;ii--){var row=elms.body.rows[ii];if(row.className.indexOf("blank")!==-1){elms.body.deleteRow(ii);}else{break;}}
elms.body.className=elms.body.className.replace(" noscroll","");}
var setBlankRows=function(){var addBlankRow=function(){var row=elms.body.insertRow();row.className="blank";for(var ii=0;ii<columns.length;ii++){var cell=row.insertCell(ii);cell.innerHTML="&nbsp;";}}
clearBlankRows();var posEnd;if(elms.body.rows.length>0){posEnd=getRowPosition(elms.body.rows.length-1);}else{addBlankRow();posEnd=getRowPosition(0);}
var rowHt=posEnd.rowBot-posEnd.rowTop;if(posEnd.rowBot<posEnd.winBot&&rowHt>0){var numBlnk=Math.ceil((posEnd.winBot-posEnd.rowBot)/rowHt);for(var ii=0;ii<numBlnk;ii++){addBlankRow();}
if(elms.body.className.indexOf("noscroll")===-1){elms.body.className+=" noscroll";}}}
var clearSelected=function(){selected={rowIndex:-1,rowElm:undefined,record:columns?thisObj.getEmptyRecord():[]};}
var setFooterText_Right=function(){if(config.showFooter===true){if(records.length>0){var winTop=elms.body.scrollTop;var rowHt=elms.body.rows[0].scrollHeight;var indxTop=Math.floor(winTop/rowHt)+1;var indxBot=indxTop+Math.ceil(elms.body.clientHeight/rowHt)-1;indxBot=Math.min(indxBot,records.length);elms.ftRight.innerHTML=indxTop+"-"+indxBot+" of "+records.length;}else{elms.ftRight.innerHTML="&nbsp;";}}}
var setFooterText_Left=function(){if(config.showFooter===true&&config.funcDisp){elms.ftLeft.innerHTML=config.funcDisp(selected.rowIndex,selected.record);}}
var ensureRowVisible=function(rowIndex){var pos=getRowPosition(rowIndex);var supportScroll=elms.body.scrollBy;if(supportScroll){if(pos.rowBot>pos.winBot){elms.body.scrollBy(0,pos.rowBot-pos.winBot);}else if(pos.rowTop<pos.winTop){elms.body.scrollBy(0,pos.rowTop-pos.winTop);}}}
var getRowPosition=function(rowIndex){var body=elms.body;var winTop=body.scrollTop;var winBot=body.scrollTop+body.clientHeight;var rowTop;var rowBot;if(body.rows.length>0){var row=body.rows[rowIndex];var row0=body.rows[0];var rowOffset=row0.offsetTop-row0.scrollHeight;rowTop=row.offsetTop-row.scrollHeight-rowOffset;rowBot=row.offsetTop-rowOffset;}
return{rowTop:rowTop,rowBot:rowBot,winTop:winTop,winBot:winBot}}
var handleRowClick=function(event){var row;if(event.target instanceof HTMLTableCellElement){var cell=event.target;row=cell.parentElement;}else if(event.target instanceof HTMLTableRowElement){row=event.target;}else{return;}
var rowIndex=row.rowIndex-elms.head.rows.length;var selIndex=(selected)?selected.rowIndex:-1;if(rowIndex!==selIndex){thisObj.selectRow(rowIndex);}}
var handleHeadClick=function(event){var colDic;var colIndex;if(event.target instanceof HTMLTableCellElement){var cell=event.target;colIndex=cell.cellIndex;colDic=columns[colIndex];}
if(colDic&&colDic.sortable){var dir=(colIndex!==sortDic.colIndex)?1:-1*sortDic.dir;thisObj.sort(colIndex,dir);}}
var handleKeyDown=function(event){var selIndex=(selected)?selected.rowIndex:0;var newIndex;if(event.key==="ArrowUp"){newIndex=selIndex-1;}else if(event.key==="ArrowDown"){newIndex=selIndex+1;}else{return;}
event.preventDefault();if(newIndex>=0&&newIndex<records.length){thisObj.selectRow(newIndex);}}
init();}
BF.__init_alerts=function(){var arrCloseBtn=document.getElementsByClassName("alert-close");for(var ii=0;ii<arrCloseBtn.length;ii++){arrCloseBtn[ii].addEventListener("click",function(){var parent=this.parentElement;parent.style.opacity="0";setTimeout(function(){parent.style.display="none";},350);});}}
BF.showToast=function(message){var t=document.createElement("div");t.innerHTML=message;t.setAttribute("id","toast");t.setAttribute("class","show");document.body.appendChild(t);var delay=3000;setTimeout(function(){t.parentNode.removeChild(t);},delay);}
BF.Modal=function(id,_options){var thisObj=this;var options=_options||{};var closeOnWindowClick=(options.closeOnWindowClick!==undefined)?options.closeOnWindowClick:true;this.onClose=new BF.Subscription();var modalElm;var modalContentElm;var arrBtnClose=[];var init=function(){if(typeof(id)==='string'){modalElm=document.getElementById(id);}else if(id instanceof BF.Element){modalElm=id.elm;}
arrBtnClose=modalElm.querySelectorAll('[data-dismiss="modal"]');for(var ii=0;ii<arrBtnClose.length;ii++){arrBtnClose[ii].addEventListener("click",thisObj.close);}
if(closeOnWindowClick){window.addEventListener("click",function(event){if(event.target==modalElm){thisObj.close();}});}
modalContentElm=modalElm.getElementsByClassName('modal-content')[0];}
this.show=function(){modalElm.style.display="block";window.setTimeout(function(){modalElm.className+=" shown";},1);if(modalContentElm.offsetHeight>window.innerHeight){modalContentElm.style.top=0;modalContentElm.style.transform="translate(0,0)";}}
this.close=function(){modalElm.className=modalElm.className.replace(" shown","");window.setTimeout(function(){modalElm.style.display="none";thisObj.onClose.callSubscribers();},500);}
init();}
BF.modalAlert=function(message,title){var modalElm=BF.__getModalAlertElm(message,title,"Close");modalElm.content.footer.row.colRt.btnClose.elm.className+=" btn-primary";modalElm.content.footer.row.colLft.btnOk.elm.style.display="none";document.body.appendChild(modalElm.elm);var mObj=new BF.Modal(modalElm,{closeOnWindowClick:false});mObj.onClose.subscribe(function(){document.body.removeChild(modalElm.elm);});mObj.show();}
BF.modalDialog=function(message,title,actionFunc){if(!actionFunc){throw new Error('WARNING: No function passed in to modal dialog.');}
var modalElm=BF.__getModalAlertElm(message,title,"Cancel");modalElm.content.footer.row.colLft.btnOk.elm.className+=" btn-primary";modalElm.content.footer.row.colRt.btnClose.elm.className+=" btn-default";document.body.appendChild(modalElm.elm);var mObj=new BF.Modal(modalElm,{closeOnWindowClick:false});mObj.onClose.subscribe(function(){document.body.removeChild(modalElm.elm);});modalElm.content.footer.row.colLft.btnOk.elm.onclick=function(){actionFunc();mObj.close();}
mObj.show();}
BF.__getModalAlertElm=function(message,title,btnCloseStr){var modalTmp={tag:"div",cls:"modal",children:{content:{tag:"div",cls:"modal-content",children:{header:{tag:"div",cls:"modal-header",children:{closeHead:{tag:"span",cls:"modal-close-head",innerHTML:"&times;"},title:{tag:"h5",cls:"modal-title",innerHTML:title}}},body:{tag:"div",cls:"modal-body",innerHTML:message},footer:{tag:"div",cls:"modal-footer",children:{row:{tag:"div",cls:"row",children:{colLft:{tag:"div",cls:"col-xs-6 text-left",children:{btnOk:{tag:"button",cls:"btn",innerHTML:"Okay"}}},colRt:{tag:"div",cls:"col-xs-6 text-right",children:{btnClose:{tag:"button",cls:"btn",innerHTML:btnCloseStr}}}}}}}}}}};var modalElm=new BF.Element(modalTmp);modalElm.content.header.closeHead.elm.setAttribute("data-dismiss","modal");modalElm.content.footer.row.colRt.btnClose.elm.setAttribute("data-dismiss","modal");return modalElm;}